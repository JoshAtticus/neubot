<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neubot API Documentation</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        .header {
            display: flex;
            align-items: center;
            margin-bottom: 30px;
        }
        .header img {
            height: 40px;
            margin-right: 15px;
        }
        h1 {
            margin: 0;
            color: #5271ff;
        }
        h2 {
            margin-top: 30px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
            color: #5271ff;
        }
        h3 {
            margin-top: 20px;
            color: #5271ff;
        }
        code {
            background-color: #f5f5f5;
            padding: 2px 5px;
            border-radius: 3px;
            font-family: monospace;
            font-size: 0.9em;
        }
        pre {
            background-color: #f5f5f5;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        .endpoint {
            background-color: #f8f9fa;
            padding: 15px;
            border-left: 4px solid #5271ff;
            margin-bottom: 20px;
            border-radius: 0 5px 5px 0;
        }
        .method {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 5px;
            color: white;
            font-weight: bold;
            margin-right: 10px;
        }
        .get {
            background-color: #61affe;
        }
        .post {
            background-color: #49cc90;
        }
        .rate-limit-section {
            background-color: #fff8e1;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
            border-left: 4px solid #ffd54f;
        }
        .example {
            margin: 15px 0;
        }
        .back-link {
            margin-top: 40px;
            display: block;
        }
    </style>
</head>
<body>
    <div class="header">
        <img src="neubot-icon.svg" alt="Neubot Icon">
        <h1>Neubot API Documentation</h1>
    </div>

    <p>
        Welcome to the Neubot API documentation. This document provides detailed information about the available API endpoints, 
        their parameters, and response formats. Neubot offers capabilities for natural language query processing, web search,
        weather data, time information, and more.
    </p>

    <div class="rate-limit-section">
        <h3>Rate Limits</h3>
        <p>All API endpoints are subject to the following rate limits:</p>
        <ul>
            <li><strong>Total Queries:</strong> 500 requests per month per IP address</li>
            <li><strong>Weather API:</strong> 30 requests per month per IP address</li>
            <li><strong>Search API:</strong> 50 requests per month per IP address</li>
        </ul>
        <p>Rate limits reset 30 days after your first request.</p>
    </div>

    <h2>Endpoints</h2>

    <div class="endpoint">
        <h3><span class="method post">POST</span> /api/query</h3>
        <p>Process a natural language query and return a response. This endpoint can handle various types of queries including time, weather, date, day of week, and web searches.</p>
        
        <h4>Request Body</h4>
        <pre><code>{
  "query": "string",       // Required: The natural language query
  "timezone": "string"     // Optional: User's timezone (e.g., "America/New_York")
}</code></pre>

        <h4>Response</h4>
        <pre><code>{
  "response": "string",        // The answer to the query
  "thoughts": [                // Array of reasoning steps
    {
      "description": "string", // Description of the thought step
      "result": "string"       // Result of the thought step
    }
  ],
  "highlightedQuery": "string" // The original query with HTML highlighting
}</code></pre>

        <h4>Example</h4>
        <div class="example">
            <p><strong>Request:</strong></p>
            <pre><code>{
  "query": "What's the weather in London?",
  "timezone": "Europe/London"
}</code></pre>

            <p><strong>Response:</strong></p>
            <pre><code>{
  "response": "The weather in London is partly cloudy with a temperature of 18.5°C/65.3°F and 72% humidity.",
  "thoughts": [
    {
      "description": "Received query",
      "result": "What's the weather in London?"
    },
    {
      "description": "User timezone",
      "result": "Europe/London"
    },
    // Additional thought steps...
  ],
  "highlightedQuery": "What's the <span class=\"query-indicator\">weather</span> in <span class=\"attribute\">London</span>?"
}</code></pre>
        </div>

        <h4>Special Response Types</h4>
        <p>
            For search queries, the response field may contain a JSON string that can be parsed into an object with search results:
        </p>
        <pre><code>{
  "type": "search_results",
  "query": "string",
  "spellcheck": "string",
  "results": [
    {
      "title": "string",
      "url": "string",
      "description": "string",
      "favicon": "string"
    }
  ],
  "meta": {
    "total": 0,
    "header": "string"
  }
}</code></pre>

        <h4>Error Responses</h4>
        <table>
            <tr>
                <th>Status Code</th>
                <th>Description</th>
            </tr>
            <tr>
                <td>400</td>
                <td>No query provided</td>
            </tr>
            <tr>
                <td>200</td>
                <td>Rate limit exceeded (response will indicate this)</td>
            </tr>
        </table>
    </div>

    <div class="endpoint">
        <h3><span class="method get">GET</span> /api/limits</h3>
        <p>Get current rate limit information for the requesting IP address.</p>
        
        <h4>Response</h4>
        <pre><code>{
  "search": {
    "limit": 50,            // Maximum search requests per month
    "remaining": 45,        // Remaining search requests
    "used": 5               // Used search requests
  },
  "weather": {
    "limit": 30,            // Maximum weather requests per month
    "remaining": 25,        // Remaining weather requests
    "used": 5               // Used weather requests
  },
  "total": {
    "limit": 500,           // Maximum total requests per month
    "remaining": 490,       // Remaining total requests
    "used": 10              // Used total requests
  },
  "reset": {
    "timestamp": 1619827200, // Unix timestamp for next reset
    "days_remaining": 25,    // Days until next reset
    "date": "2025-05-16"     // Human-readable reset date
  }
}</code></pre>

        <h4>Example</h4>
        <div class="example">
            <p><strong>Request:</strong></p>
            <pre><code>GET /api/limits</code></pre>

            <p><strong>Response:</strong></p>
            <pre><code>{
  "search": {
    "limit": 50,
    "remaining": 45,
    "used": 5
  },
  "weather": {
    "limit": 30,
    "remaining": 28,
    "used": 2
  },
  "total": {
    "limit": 500,
    "remaining": 493,
    "used": 7
  },
  "reset": {
    "timestamp": 1620518400,
    "days_remaining": 28,
    "date": "2025-05-16"
  }
}</code></pre>
        </div>
    </div>

    <h2>Query Capabilities</h2>
    <p>
        The Neubot API can process various types of natural language queries:
    </p>
    <table>
        <tr>
            <th>Capability</th>
            <th>Description</th>
            <th>Example Query</th>
        </tr>
        <tr>
            <td>Time</td>
            <td>Get current time, optionally for a specific location</td>
            <td>"What time is it in Tokyo?"</td>
        </tr>
        <tr>
            <td>Weather</td>
            <td>Get weather information for a location</td>
            <td>"How's the weather in New York?"</td>
        </tr>
        <tr>
            <td>Date</td>
            <td>Get the current date</td>
            <td>"What's today's date?"</td>
        </tr>
        <tr>
            <td>Day</td>
            <td>Get the current day of the week</td>
            <td>"What day is it today?"</td>
        </tr>
        <tr>
            <td>Web Search</td>
            <td>Search the web for information</td>
            <td>"Tell me about climate change"</td>
        </tr>
    </table>

    <h2>Setting Up</h2>
    <p>
        The Neubot API requires the following environment variables:
    </p>
    <ul>
        <li><code>OPENWEATHER_API_KEY</code> - API key for OpenWeatherMap</li>
        <li><code>BRAVE_SEARCH_TOKEN</code> - API token for Brave Search</li>
    </ul>
    <p>
        These can be set in a <code>.env</code> file in the root directory.
    </p>

    <a href="/" class="back-link">← Back to Neubot</a>
</body>
</html>